(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58a11729"],{6682:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("page-title",{attrs:{heading:t.heading,subheading:t.subheading,icon:t.icon,actions:t.actions}}),n("b-table",{attrs:{id:"agent-session-list",striped:!0,bordered:!0,outlined:!1,small:!0,hover:!0,dark:!1,fixed:!1,"foot-clone":!1,"per-page":t.table.perPage,"current-page":t.table.currentPage,items:t.table.items,fields:t.table.fields},scopedSlots:t._u([{key:"cell(assignedToAgent)",fn:function(e){return["BOT"==e.item.mode?n("font-awesome-icon",{style:{color:"grey"},attrs:{icon:"robot"}}):t._e(),"AGENT"==e.item.mode?n("font-awesome-icon",{style:{color:"grey"},attrs:{icon:"user"}}):t._e(),t._v("\n                 "+t._s(e.item.assignedToAgent)+"\n            ")]}},{key:"cell(account)",fn:function(e){return[n("i",{staticClass:"fab",class:t.MyDict.socialPrefix(t.session.contactType)}),t._v("\n                  "+t._s(t.session.lane)+"\n            ")]}},{key:"cell(contact)",fn:function(e){return[n("i",{staticClass:"fab",class:t.MyDict.socialPrefix(t.session.contactType)}),t._v("\n                  "+t._s(e.item.contact.phone)+"\n            ")]}},{key:"cell(createdBy)",fn:function(e){return[t._v("\n                  "+t._s(t.session.createdBy)+"\n            ")]}},{key:"cell(template)",fn:function(e){return[n("span",{staticClass:"fa fa-comment",attrs:{"cursor-pointer":"",id:"template-details-"+e.index}}),t._v(" "+t._s(e.item.templateId)+"\n                "),n("b-popover",{attrs:{triggers:"hover focus",target:"template-details-"+e.index,"custom-class":"message-preview"},scopedSlots:t._u([{key:"default",fn:function(){return[n("div",{staticClass:"message-text"},[t._v(t._s(e.item.text))])]},proxy:!0}],null,!0)})]}},{key:"cell(initiated)",fn:function(e){return[t._v("\n                "+t._s(t._f("formatDate")(e.item.stamps.INIT))+"\n            ")]}},{key:"cell(status)",fn:function(e){return[n("div",{staticClass:"fa fa-info-circle",attrs:{"cursor-pointer":"",id:"job-status-details-"+e.index}}),t._v("\n                  "+t._s(e.item.status)+"\n                "),e.item.logs?n("div",{staticClass:"fa fa-exclamation-triangle float-right",staticStyle:{"line-height":"21px"},attrs:{"cursor-pointer":"",id:"job-logs-details-"+e.index}}):t._e(),n("b-popover",{attrs:{triggers:"hover focus",target:"job-status-details-"+e.index},scopedSlots:t._u([{key:"title",fn:function(){return t._l(e.item.stamps,(function(e,a){return n("div",{staticClass:"text-align-left row",staticStyle:{width:"400px"}},[n("small",{staticClass:"col-2"},[t._v(" "+t._s(a)+" ")]),n("small",{staticClass:"col-10"},[t._v(":  "+t._s(t._f("formatDate")(e)))])])}))},proxy:!0}],null,!0)}),e.item.logs?n("b-popover",{attrs:{triggers:"hover focus",target:"job-logs-details-"+e.index},scopedSlots:t._u([{key:"title",fn:function(){return t._l(e.item.logs,(function(e,a){return n("small",{staticClass:"text-align-left"},[t._v(" \n                     "+t._s(e)+"\n                    ")])}))},proxy:!0}],null,!0)}):t._e()]}}])}),n("b-pagination",{attrs:{"total-rows":t.table.rows,"per-page":t.table.perPage,"aria-controls":"agent-session-list"},model:{value:t.table.currentPage,callback:function(e){t.$set(t.table,"currentPage",e)},expression:"table.currentPage"}})],1)},s=[],i=(n("96cf"),n("3b8d")),o=n("d51b"),r=n("d166"),c=n("df4b"),l=n("ecee"),u=n("c074"),d=n("ad3d");l["c"].add(u["Q"],u["u"],u["a"],u["d"],u["O"],u["t"],u["w"],u["J"],u["R"]);var g={components:{PageTitle:o["a"],"font-awesome-icon":d["a"],AgentChat:c["a"]},data:function(){return{MyFlags:r["c"],MyDict:r["b"],MyConst:r["a"],heading:"Bulk Messages",subheading:"Select date range for report",icon:"pe-7s-chat icon-gradient bg-tempting-azure fa fa-mail-bulk",actions:[{label:"View Past Jobs",name:"BULK_PUSH_JOBS",link:"/app/moderate/bulk-push-jobs",type:"link"}],input:{daterange:{hidden:!0,startDate:null,endDate:null}},table:{fields:[{key:"account",label:"Account"},{key:"contact",label:"Contact"},{key:"sessionId",label:"SessionId"},{key:"template",label:"Template"},{key:"createdBy",label:"by"},{key:"initiated",label:"@"},{key:"status",label:"Status"}],items:[],perPage:25,currentPage:1,rows:0},session:null}},mounted:function(t){this.getItems()},methods:{getItems:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$service.submit("/api/message/bulk/push/messages",{contactType:"WHATSAPP",bulkSessionId:this.$route.params.bulkSessionId});case 2:e=t.sent,this.table.items=e.results,this.table.rows=this.table.items.length,this.session=e.meta,console.log("sessions",e,this.table);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),deleteItem:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,n){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("PostRequest",{url:"/api/message/session/import/trash",params:e});case 2:a=t.sent,this.sessions.items=a.results,this.sessions.rows=this.sessions.items.length;case 5:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}(),hideChat:function(t){this.session=null},showChat:function(t){this.session&&this.session.sessionId==t.sessionId?this.session=null:this.session=t}}},p=g,f=(n("a672"),n("2877")),m=Object(f["a"])(p,a,s,!1,null,"1f612b40",null);e["default"]=m.exports},"748d":function(t,e,n){"use strict";n("d584")},a672:function(t,e,n){"use strict";n("b264")},b264:function(t,e,n){},d51b:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-page-title"},[n("div",{staticClass:"page-title-wrapper"},[n("div",{staticClass:"page-title-heading"},[n("div",{staticClass:"page-title-icon"},[n("i",{class:t.icon})]),n("div",[t._v("\n                "+t._s(t.heading)+"\n                "),n("div",{staticClass:"page-title-subheading"},[t._v("\n                    "+t._s(t.subheading)+"\n                ")])])]),n("div",{staticClass:"page-title-actions"},[t._l(t.actions,(function(e){return e.hidden||!1===t.actionShow[e.name]?t._e():n("span",[e.link?n("router-link",{staticClass:"btn-shadow d-inline-flex align-items-center btn",class:{"btn-link":"link"==e.type,"btn-success":!e.type||"button"==e.type},attrs:{tag:"button",to:e.link,type:"button"}},[e.icon?n("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:e.icon}}):t._e(),t._v("\n                    "+t._s(e.label)+" \n                ")],1):n("button",{staticClass:"btn-shadow d-inline-flex align-items-center btn",class:{"btn-link":"link"==e.type,"btn-success":!e.type||"button"==e.type},on:{click:function(n){return t.clickAction(e)}}},[e.icon?n("font-awesome-icon",{staticClass:"mr-2",attrs:{icon:e.icon}}):t._e(),t._v("\n                    "+t._s(e.label)+" \n                ")],1)],1)})),t.dateranegeinput&&t.dateranegeinput.hidden?n("date-range-picker",{attrs:{opens:"left","time-picker":!1,ranges:t.dateranegeinput.ranges},on:{select:t.onDateRangeSelect,update:t.onDateRangeUpdate},scopedSlots:t._u([{key:"input",fn:function(e){return[t._v("\n              "+t._s(t._f("date")(e.startDate))+" - "+t._s(t._f("date")(e.endDate))+"\n            ")]}}],null,!1,3768211459),model:{value:t.dateranegeinput.range,callback:function(e){t.$set(t.dateranegeinput,"range",e)},expression:"dateranegeinput.range"}}):t._e()],2)])])},s=[],i=(n("7f7f"),n("ecee")),o=n("c074"),r=n("ad3d"),c=n("bbf5"),l=n.n(c),u=(n("53b4"),n("2ead"),n("c1df")),d=n.n(u);function g(t){return t.hour(0).minute(0).seconds(0).milliseconds(0)}function p(t){return t.hour(23).minute(59).seconds(59).milliseconds(999)}i["c"].add(o["N"],o["H"]);var f={components:{"font-awesome-icon":r["a"],DateRangePicker:l.a},data:function(){var t=this;return{dateranegeinput:function(){if(!t.daterange)return null;var e=t.daterange.startDate||g(d()()).toDate(),n=t.daterange.endDate||p(d()()).toDate();return{range:{startDate:e,endDate:n},ranges:{Today:[g(d()()).toDate(),p(d()()).toDate()],Yesterday:[g(d()().subtract(1,"day")).toDate(),p(d()().subtract(1,"day")).toDate()],"This month":[g(d()().date(1)).toDate(),p(d()()).toDate()],"Last month":[g(d()().subtract(1,"month").date(1)).toDate(),p(d()().date(0)).toDate()],"This year":[g(d()().month(0).date(1)).toDate(),p(d()()).toDate()],"Last year":[g(d()().subtract(1,"year").month(0).date(1)).toDate(),p(d()().month(0).date(0)).toDate()]}}}()}},filters:{date:function(t){return t?t.toLocaleString():""}},created:function(t){this.daterange&&(this.daterange.startDate||(this.daterange.startDate=g(d()()).toDate()),this.daterange.endDate||(this.daterange.endDate=p(d()()).toDate()))},methods:{onDateRangeSelect:function(t){console.log("select",t)},onDateRangeUpdate:function(t){console.log("c_update",t),this.daterange&&(this.daterange.startDate=t.startDate,this.daterange.endDate=t.endDate,this.$emit("dateRangeOnUpdate",t))},clickAction:function(t){this.$emit("action",t)},action:function(t,e,n){for(var a in this.actions)if(this.actions[a].name==t){this.actions[a][e]=n;break}}},props:{icon:String,heading:String,subheading:String,actions:Array,daterange:{type:Object},actionShow:{type:Object,default:function(){return{message:"hello"}}}}},m=f,h=(n("748d"),n("2877")),b=Object(h["a"])(m,a,s,!1,null,null,null);e["a"]=b.exports},d584:function(t,e,n){}}]);